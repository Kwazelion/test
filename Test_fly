
from tkinter import *
import time
import random

root=Tk()
root.title('nazvanie')
root.geometry('500x600')
root.configure(background="snow")
canvas=Canvas(root, width=200, height=600, bg='light gray')
#canvas.pack(side=RIGHT,fill=Y, expand=1)
canvas.place(x=150,y=0)
shell=[]
enemys=[]
level=1
text = Text(width=10, height=2)
text.place(x=1,y=1)
b_l = Button(text="left", width=3, height=3)
b_r = Button(text="right", width=3, height=3)
b_l.place(x=10,y=540)
b_r.place(x=70,y=540)


class Cheep():
    def __init__ (self):
        self.y=570
        self.x=100
        self.hp=1000
        self.score=0
        self.color="green"
        self.speed=5
        self.size=25
        self.id=canvas.create_polygon(self.x,self.y,
										self.x+self.size,self.y+self.size,
										self.x-self.size,self.y+self.size,
										self.x,self.y,fill=self.color)
	
    def move(self):
        self.say()
        if self.hp<1:
            self.die()
        self.x += self.speed
        if self.x>175:
            self.speed =-self.speed
        if self.x<25:
            self.speed =-self.speed
        canvas.coords(self.id, self.x,self.y,
										self.x+self.size,self.y+self.size,
										self.x-self.size,self.y+self.size,
										self.x,self.y)
		
    def say(self):
        text.delete(1.0, END)
        text.insert(1.0, "score="+str(self.score)+"\n")
        text.insert(2.1, "hp="+str(self.hp))
										
    def die(self):
        print("game over")
		
class Boolet():
    def __init__ (self,x,y,my):
        if my==1:
            self.color="green"
            self.size=-5
            self.speed=-10
        else:
            self.color="red"
            self.size=5
            self.speed=10
        self.x=x
        self.y=y
        self.id=canvas.create_line(self.x,self.y,
										self.x,self.y+self.size,
										fill=self.color)
										
    def move(self):
        self.y+=self.speed
        if self.y >800 or self.y<0:
            self.die()
        canvas.coords(self.id, self.x,self.y,self.x,self.y+self.size)
        for test in enemys:
            if test.y==self.y:
                if test.x-10<self.x:
                    if test.x+10>self.x:
                        self.kill()
                        test.stop()
        if raketa.y==self.y:
            if raketa.x-25<self.x:
                if raketa.x+25>self.x:
                    self.kill()
                    raketa.hp-=1
	
    def kill(self):
        self.die()
		
    def die(self):
        canvas.delete(self.id)
        for boolet in shell:
            if self.id == boolet.id:
                tmp=shell.index(boolet)
                del shell[tmp]

class Enemy():
    def __init__ (self,x,y):
        self.hp=10
        self.color="red"
        self.x=x
        self.y=y
        self.size=10
        self.id=canvas.create_polygon(self.x,self.y,
										self.x-self.size,self.y-self.size,
										self.x+self.size,self.y-self.size,
										self.x,self.y,fill=self.color)
	
    def shoot(self):
        global shell
        if random.randint(1,9)==3:
            new_boolet=Boolet(self.x,self.y,7)
            shell += [new_boolet]
        
		
    def stop(self):
        self.die()
        self.tmp=0
        self.boom=canvas.create_oval(self.x-10,self.y-10,
							        self.x+10,self.y+10,fill="red")
        self.colorin()
	
    def colorin(self):
        color_boom=["red","blue","yellow","black","red","white"]
        canvas.itemconfig(self.boom, fill=color_boom[int(self.tmp%6)])
        self.tmp+=1
        if self.tmp < 6 :
            root.after(100,self.colorin)
        else:
            canvas.delete(self.boom)
		
    def die(self):
        raketa.score+=1
        canvas.delete(self.id)
        for enemy in enemys:
            if self.id == enemy.id:
                tmp=enemys.index(enemy)
                del enemys[tmp]


raketa=Cheep()

def new_game():
    global enemys,raketa,level
        
    if level >= 2:
        for y in range (20,60,30):
            for x in range(30,170,30):
                new_enemy=Enemy(x,y)
                enemys+=[new_enemy]
        level+=1
        
    if level==1:
        for x in range (30,170,30):
            new_enemy=Enemy(x,20)
            enemys+=[new_enemy]
        level+=1

def game():
    global shell,level
    if len(enemys)==0:
        new_game()
    if random.randint(1,3)==1:
        new_boolet=Boolet(raketa.x,raketa.y,1)
        shell += [new_boolet]
    
    for enemy in enemys:
        enemy.shoot()
        
    for boolet in shell:
        boolet.move()
        
    #b_l.config(command=change)

    raketa.move()
    canvas.update()
    root.after(100,game)

new_game()
game()
root.mainloop()
